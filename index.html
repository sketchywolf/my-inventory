<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Product Inventory Search</title>

  <style>
    /* ========== CYBERPUNK THEME (NEON) ========== */
    :root{
      --bg0:#05040a;
      --bg1:#09071a;
      --panel: rgba(10, 10, 18, 0.72);
      --panel2: rgba(15, 15, 28, 0.72);
      --border: rgba(160, 255, 255, 0.22);

      --text:#e9f7ff;
      --muted: rgba(233, 247, 255, 0.7);

      --neon-cyan:#25f6ff;
      --neon-pink:#ff2bd6;
      --neon-purple:#9b5cff;
      --neon-green:#31ff8b;

      --shadow: 0 10px 40px rgba(0,0,0,.55);
      --glow-cyan: 0 0 12px rgba(37,246,255,.45);
      --glow-pink: 0 0 12px rgba(255,43,214,.35);
      --glow-purple: 0 0 14px rgba(155,92,255,.35);

      --radius: 14px;
    }

    /* Light mode (still cyber) */
    body.light{
      --bg0:#f3f7ff;
      --bg1:#ffffff;
      --panel: rgba(255,255,255,.78);
      --panel2: rgba(245,248,255,.85);
      --border: rgba(20, 40, 60, 0.18);

      --text:#0c1120;
      --muted: rgba(12, 17, 32, 0.65);

      --shadow: 0 12px 30px rgba(10, 20, 40, .12);
      --glow-cyan: 0 0 12px rgba(37,246,255,.25);
      --glow-pink: 0 0 12px rgba(255,43,214,.18);
      --glow-purple: 0 0 12px rgba(155,92,255,.20);
    }

    * { box-sizing: border-box; }

    body{
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      max-width: 1300px;
      margin: 0 auto;
      padding: 16px;
      background: radial-gradient(1200px 700px at 20% -10%, rgba(37,246,255,.16), transparent 55%),
                  radial-gradient(900px 600px at 110% 10%, rgba(255,43,214,.12), transparent 55%),
                  linear-gradient(180deg, var(--bg0), var(--bg1));
      color: var(--text);
      transition: background .3s ease, color .3s ease;
      overflow-x: hidden;
    }

    /* Subtle scanlines */
    body::before{
      content:"";
      position: fixed;
      inset: 0;
      pointer-events: none;
      background:
        repeating-linear-gradient(
          to bottom,
          rgba(255,255,255,0.03),
          rgba(255,255,255,0.03) 1px,
          transparent 1px,
          transparent 4px
        );
      opacity: .18;
      mix-blend-mode: overlay;
      z-index: 0;
    }

    /* Grain */
    body::after{
      content:"";
      position: fixed;
      inset: 0;
      pointer-events:none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='180' height='180' filter='url(%23n)' opacity='.25'/%3E%3C/svg%3E");
      opacity: .05;
      z-index: 0;
    }

    header, main, aside, section { position: relative; z-index: 1; }
    
body.dark { color-scheme: dark; }
body.light { color-scheme: light; }

body.dark select{
  background: linear-gradient(180deg, rgba(12,16,26,.92), rgba(7,9,14,.92));
  color: var(--text);
  border: 1px solid rgba(37,246,255,.25);
}
body.dark select option{
  background: #0b0f1a;
  color: #e9f7ff;
}

body.light select{
  background: rgba(255,255,255,.9);
  color: #0c1120;
  border: 1px solid rgba(20,40,60,.18);
}
body.light select option{
  background: #ffffff;
  color: #0c1120;
}
    /* ========== STICKY HEADER ========== */
    .sticky-header{
      position: sticky;
      top: 0;
      z-index: 1000;
      background: linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,0));
      backdrop-filter: blur(10px);
      padding-top: 10px;
      padding-bottom: 12px;
      margin-bottom: 18px;
      border-bottom: 1px solid var(--border);
    }

    .top-bar{
      display:flex;
      justify-content: space-between;
      align-items:center;
      gap: 12px;
      margin-bottom: 14px;
    }

    /* ========== GLITCH TITLE (hover) ========== */
    .glitch{
      position: relative;
      display: inline-block;
      margin: 0;
      font-size: 22px;
      letter-spacing: .6px;
      text-transform: uppercase;
      background: linear-gradient(90deg, var(--neon-cyan), var(--neon-pink));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow: var(--glow-cyan), var(--glow-pink);
    }
    .glitch::before,
    .glitch::after{
      content: attr(data-text);
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      background: linear-gradient(90deg, var(--neon-cyan), var(--neon-pink));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      opacity: 0;
      pointer-events: none;
    }
    .glitch:hover::before{
      opacity: .8;
      transform: translate(1px, -1px);
      text-shadow: 0 0 10px rgba(37,246,255,.45);
      animation: glitchShift 700ms steps(2,end) infinite;
      clip-path: polygon(0 2%, 100% 2%, 100% 25%, 0 25%);
    }
    .glitch:hover::after{
      opacity: .75;
      transform: translate(-1px, 1px);
      text-shadow: 0 0 10px rgba(255,43,214,.35);
      animation: glitchShift 650ms steps(2,end) infinite reverse;
      clip-path: polygon(0 55%, 100% 55%, 100% 78%, 0 78%);
    }
    @keyframes glitchShift{
      0%{ transform: translate(0,0); }
      20%{ transform: translate(1px,-1px); }
      40%{ transform: translate(-1px,1px); }
      60%{ transform: translate(2px,0); }
      80%{ transform: translate(-2px,0); }
      100%{ transform: translate(0,0); }
    }

    /* ========== BUTTONS / INPUTS ========== */
    .theme-toggle{
      padding: 10px 14px;
      font-size: 13px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: linear-gradient(135deg, rgba(37,246,255,.18), rgba(255,43,214,.12));
      color: var(--text);
      cursor: pointer;
      white-space: nowrap;
      box-shadow: var(--shadow);
      transition: transform .12s ease, box-shadow .12s ease, border-color .2s ease, filter .2s ease;
      position: relative;
      overflow: hidden;
    }

    /* ========== SOUNDLESS PULSE (buttons) ========== */
    .theme-toggle::after,
    .btn-pulse::after{
      content:"";
      position:absolute;
      inset: -30px;
      background: radial-gradient(closest-side, rgba(37,246,255,.18), transparent 60%);
      opacity: 0;
      transform: scale(.7);
      transition: opacity .2s ease;
      pointer-events:none;
    }
    .theme-toggle:hover::after,
    .btn-pulse:hover::after{
      opacity: 1;
      animation: pulse 900ms ease-out infinite;
    }
    @keyframes pulse{
      0%{ transform: scale(.65); opacity: .0; }
      30%{ opacity: .65; }
      100%{ transform: scale(1.15); opacity: 0; }
    }

    .theme-toggle:hover{
      transform: translateY(-1px);
      border-color: rgba(37,246,255,.55);
      box-shadow: var(--shadow), var(--glow-cyan);
      filter: brightness(1.05);
    }

    .search-box{
      display:flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 6px;
    }

    .search-box input,
    .search-box select,
    .suggestion-form input,
    .suggestion-form textarea,
    .admin-login-form input,
    .admin-product-form input,
    .admin-product-form select,
    .admin-product-form textarea{
      padding: 10px 12px;
      font-size: 15px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: linear-gradient(180deg, var(--panel), var(--panel2));
      color: var(--text);
      outline: none;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.03);
      transition: border-color .2s ease, box-shadow .2s ease, transform .12s ease;
    }

    .search-box input::placeholder,
    .suggestion-form input::placeholder,
    .suggestion-form textarea::placeholder,
    .admin-login-form input::placeholder,
    .admin-product-form input::placeholder,
    .admin-product-form textarea::placeholder{
      color: rgba(233,247,255,.45);
    }

    .search-box input{ flex: 1 1 260px; }
    .search-box select{
      flex: 0 0 210px;
      cursor: pointer;
    }

    .search-box button,
    .suggestion-form button,
    .admin-login-form button,
    .admin-product-form button{
      padding: 10px 16px;
      font-size: 15px;
      cursor: pointer;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.08);
      background:
        linear-gradient(135deg, rgba(37,246,255,.22), rgba(155,92,255,.18)),
        radial-gradient(300px 120px at 20% 30%, rgba(255,43,214,.25), transparent 55%);
      color: var(--text);
      box-shadow: var(--shadow), var(--glow-cyan);
      transition: transform .12s ease, filter .2s ease, box-shadow .2s ease;
      position: relative;
      overflow: hidden;
    }
    .search-box button:hover,
    .suggestion-form button:hover,
    .admin-login-form button:hover,
    .admin-product-form button:hover{
      transform: translateY(-1px);
      filter: brightness(1.06);
      box-shadow: var(--shadow), var(--glow-cyan), var(--glow-pink);
    }

    .search-box button::after,
    .suggestion-form button::after,
    .admin-login-form button::after,
    .admin-product-form button::after{
      content:"";
      position:absolute;
      inset:-30px;
      background: radial-gradient(closest-side, rgba(37,246,255,.18), transparent 60%);
      opacity: 0;
      transform: scale(.7);
      transition: opacity .2s ease;
      pointer-events:none;
    }
    .search-box button:hover::after,
    .suggestion-form button:hover::after,
    .admin-login-form button:hover::after,
    .admin-product-form button:hover::after{
      opacity: 1;
      animation: pulse 900ms ease-out infinite;
    }

    /* ========== MAIN LAYOUT ========== */
    .layout{
      display: grid;
      grid-template-columns: 1fr 460px;
      gap: 16px;
      align-items: start;
    }

    .sidebar{
      position: sticky;
      top: 140px;
      align-self: start;
      max-height: calc(100vh - 160px);
      overflow-y: auto;
      padding-right: 4px;
    }
    .sidebar::-webkit-scrollbar{ width: 10px; }
    .sidebar::-webkit-scrollbar-thumb{
      background: rgba(37,246,255,.18);
      border: 1px solid rgba(37,246,255,.22);
      border-radius: 99px;
    }

    @media (max-width: 900px){
      .layout{ grid-template-columns: 1fr; }
      .sidebar{
        position: static;
        max-height: none;
        overflow: visible;
        padding-right: 0;
      }
    }

    /* ========== RESULT CARDS ========== */
    .result-card{
      border: 1px solid transparent;
      border-radius: 14px;

      background:
        linear-gradient(180deg, rgba(12,16,26,.92), rgba(7,9,14,.92)) padding-box,
        linear-gradient(135deg, #25f6ff, #ff2bd6, #9b5cff, #25f6ff) border-box;

      background-size: 100% 100%, 300% 300%;

      padding: 16px;
      margin-bottom: 12px;

      box-shadow:
        0 0 0 1px rgba(37,246,255,.2),
        0 10px 30px rgba(0,0,0,.55);

      opacity: 0;
      transform: translateY(10px);
      animation:
        fadeIn 0.35s forwards,
        neonShift 10s linear infinite;
    }

    @keyframes neonShift {
      0%   { background-position: 0% 50%, 0% 50%; }
      50%  { background-position: 0% 50%, 100% 50%; }
      100% { background-position: 0% 50%, 0% 50%; }
    }

    .result-card:hover{
      box-shadow:
        0 0 0 1px rgba(37,246,255,.4),
        0 0 20px rgba(37,246,255,.25),
        0 0 26px rgba(255,43,214,.2),
        0 12px 36px rgba(0,0,0,.6);
      transform: translateY(-2px);
      transition: transform .12s ease;
    }

    /* Hover “glitch” effect for cards */
    .result-card:hover .result-name{
      position: relative;
      animation: textGlitch 450ms steps(2,end) 1;
    }
    @keyframes textGlitch{
      0%{ transform: translate(0,0); }
      25%{ transform: translate(1px,-1px); }
      50%{ transform: translate(-1px,1px); }
      75%{ transform: translate(2px,0); }
      100%{ transform: translate(0,0); }
    }

    .result-header{
      display:flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 10px;
      margin-bottom: 10px;
    }

    .result-model{
      margin: 0 0 6px;
      font-size: 12px;
      letter-spacing: .5px;
      text-transform: uppercase;
      color: var(--muted);
    }

    .result-name{
      margin: 0 0 6px;
      font-size: 18px;
      letter-spacing: .3px;
      text-shadow: var(--glow-cyan);
    }

    .result-meta{
      margin: 0;
      font-size: 13px;
      color: var(--muted);
    }

    .chip{
      display:inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(37,246,255,.25);
      background: rgba(37,246,255,.08);
      box-shadow: var(--glow-cyan);
      font-size: 12px;
      margin-left: 6px;
      color: var(--text);
    }

    .result-description{
      margin: 10px 0 0;
      color: rgba(233,247,255,.82);
      line-height: 1.45;
    }

    .result-image{
      margin-top: 14px;
      max-width: 100%;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: 0 12px 35px rgba(0,0,0,.55);
    }

    .result-actions{
      display:flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 8px;
      min-width: 120px;
    }

    .compare-toggle{
      font-size: 13px;
      display:flex;
      align-items:center;
      gap: 6px;
      cursor:pointer;
      user-select:none;
      color: rgba(233,247,255,.85);
    }

    .add-cart-btn{
      padding: 8px 12px;
      font-size: 13px;
      border-radius: 999px;
      border: 1px solid rgba(255,43,214,.28);
      background: linear-gradient(135deg, rgba(255,43,214,.22), rgba(37,246,255,.16));
      color: var(--text);
      cursor:pointer;
      box-shadow: var(--glow-pink);
      transition: transform .12s ease, filter .2s ease;
      white-space: nowrap;
      position: relative;
      overflow: hidden;
    }
    .add-cart-btn:hover{
      transform: translateY(-1px);
      filter: brightness(1.06);
    }
    .add-cart-btn::after{
      content:"";
      position:absolute;
      inset:-30px;
      background: radial-gradient(closest-side, rgba(255,43,214,.22), transparent 60%);
      opacity: 0;
      transform: scale(.7);
      pointer-events:none;
      transition: opacity .2s ease;
    }
    .add-cart-btn:hover::after{
      opacity: 1;
      animation: pulse 900ms ease-out infinite;
    }

    @keyframes fadeIn{
      to{ opacity:1; transform: translateY(0); }
    }

    /* ========== LOADER / NO RESULT ========== */
    .loader{
      border: 6px solid rgba(255,255,255,.18);
      border-top: 6px solid var(--neon-cyan);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
      display: none;
      box-shadow: var(--glow-cyan);
    }
    @keyframes spin { to { transform: rotate(360deg);} }

    .no-result{
      margin-top: 10px;
      color: var(--neon-pink);
      font-weight: 700;
      display:none;
      text-shadow: var(--glow-pink);
    }

    /* ========== COMPARE SECTION ========== */
    #compareSection{
      margin-top: 22px;
      padding: 16px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(37,246,255,.08), rgba(255,43,214,.05));
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      display:none;
    }

    .compare-actions{
      display:flex;
      justify-content: space-between;
      align-items:center;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }

    .compare-count{
      font-size: 13px;
      color: var(--muted);
    }

    .clear-compare-btn{
      padding: 8px 12px;
      font-size: 13px;
      border-radius: 999px;
      border: 1px solid rgba(37,246,255,.25);
      background: rgba(37,246,255,.08);
      color: var(--text);
      cursor:pointer;
      box-shadow: var(--glow-cyan);
      position: relative;
      overflow:hidden;
    }
    .clear-compare-btn::after{
      content:"";
      position:absolute;
      inset:-30px;
      background: radial-gradient(closest-side, rgba(37,246,255,.18), transparent 60%);
      opacity: 0;
      transform: scale(.7);
      pointer-events:none;
      transition: opacity .2s ease;
    }
    .clear-compare-btn:hover::after{
      opacity: 1;
      animation: pulse 900ms ease-out infinite;
    }

    .compare-table{
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
      overflow-x:auto;
    }
    .compare-table th,
    .compare-table td{
      border: 1px solid rgba(255,255,255,.10);
      padding: 10px;
      text-align:left;
      vertical-align: top;
    }
    .compare-table th{
      background: rgba(0,0,0,.15);
      color: rgba(233,247,255,.92);
      text-transform: uppercase;
      letter-spacing: .4px;
      font-size: 12px;
    }
    .compare-image{
      max-width: 110px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,.12);
      display:block;
      box-shadow: 0 10px 25px rgba(0,0,0,.55);
    }

    /* ========== CART / QUOTATION (CARD LIST LAYOUT) ========== */
    #cartSection{
      padding: 14px;
      border-radius: var(--radius);
      display: none; /* keep this */
    }

    .cart-actions{
      display:flex;
      justify-content: space-between;
      align-items:center;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }

    /* Animated neon frame (reusable) */
    .neon-frame{
      border: 1px solid transparent;
      border-radius: var(--radius);

      background:
        linear-gradient(180deg, rgba(12,16,26,.92), rgba(7,9,14,.92)) padding-box,
        linear-gradient(135deg, #25f6ff, #ff2bd6, #9b5cff, #25f6ff) border-box;

      background-size: 100% 100%, 300% 300%;
      animation: neonShift 10s linear infinite;

      box-shadow:
        0 0 0 1px rgba(37,246,255,.2),
        0 10px 30px rgba(0,0,0,.55);
    }

    .neon-frame:hover{
      box-shadow:
        0 0 0 1px rgba(37,246,255,.4),
        0 0 20px rgba(37,246,255,.25),
        0 0 26px rgba(255,43,214,.2),
        0 12px 36px rgba(0,0,0,.6);
    }

    .cart-count{
      font-size: 13px;
      color: var(--muted);
    }

    .download-quote-btn{
      padding: 10px 14px;
      font-size: 13px;
      border-radius: 999px;
      border: 1px solid rgba(49,255,139,.25);
      background: linear-gradient(135deg, rgba(49,255,139,.18), rgba(37,246,255,.10));
      color: var(--text);
      cursor:pointer;
      box-shadow: 0 0 14px rgba(49,255,139,.25);
      white-space: nowrap;
      transition: transform .12s ease, filter .2s ease;
      position: relative;
      overflow:hidden;
    }
    .download-quote-btn:hover{
      transform: translateY(-1px);
      filter: brightness(1.06);
    }
    .download-quote-btn::after{
      content:"";
      position:absolute;
      inset:-30px;
      background: radial-gradient(closest-side, rgba(49,255,139,.18), transparent 60%);
      opacity: 0;
      transform: scale(.7);
      pointer-events:none;
      transition: opacity .2s ease;
    }
    .download-quote-btn:hover::after{
      opacity: 1;
      animation: pulse 900ms ease-out infinite;
    }

    .cart-list{
      display:flex;
      flex-direction: column;
      gap: 10px;
    }

    .cart-item{
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(0,0,0,.22), rgba(0,0,0,.12));
      box-shadow: 0 14px 35px rgba(0,0,0,.45);
      padding: 12px;
      position: relative;
      overflow: hidden;
    }

    /* animated border on cart items too */
    .cart-item::after{
      content:"";
      position:absolute;
      inset:-2px;
      background: conic-gradient(from 0deg,
        rgba(255,43,214,.0),
        rgba(255,43,214,.55),
        rgba(37,246,255,.55),
        rgba(155,92,255,.55),
        rgba(255,43,214,.0)
      );
      filter: blur(12px);
      opacity: .18;
      animation: neonBorder 5.2s linear infinite;
      z-index: 0;
    }
    .cart-item::before{
      content:"";
      position:absolute;
      inset: 1px;
      background: linear-gradient(180deg, rgba(0,0,0,.24), rgba(0,0,0,.12));
      border-radius: 12px;
      z-index: 0;
    }
    .cart-item > *{ position: relative; z-index: 1; }

    @keyframes neonBorder{
      to{ transform: rotate(360deg); }
    }

    .cart-top{
      display:flex;
      justify-content: space-between;
      align-items:flex-start;
      gap: 10px;
      margin-bottom: 8px;
    }

    .cart-title{
      display:flex;
      flex-direction: column;
      gap: 4px;
      min-width: 0;
    }

    .cart-title .brand{
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: .45px;
      color: var(--muted);
    }
    .cart-title .model{
      font-size: 14px;
      font-weight: 800;
      letter-spacing: .3px;
      text-shadow: var(--glow-cyan);
      word-break: break-word;
    }

    .cart-desc{
      font-size: 13px;
      color: rgba(233,247,255,.86);
      line-height: 1.45;
      margin: 6px 0 10px;
      word-break: break-word;
    }

    .cart-controls{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }

    .qty-wrap{
      display:flex;
      align-items:center;
      gap: 8px;
      font-size: 12px;
      color: var(--muted);
    }

    .cart-item input[type="number"]{
      width: 80px;
      padding: 7px 10px;
      border-radius: 10px;
      border: 1px solid rgba(37,246,255,.20);
      background: rgba(0,0,0,.22);
      color: var(--text);
      outline: none;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.03);
    }

    .remove-cart-btn{
      padding: 7px 10px;
      font-size: 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,43,214,.26);
      background: rgba(255,43,214,.10);
      color: var(--text);
      cursor:pointer;
      box-shadow: var(--glow-pink);
      transition: transform .12s ease, filter .2s ease;
      position: relative;
      overflow:hidden;
    }
    .remove-cart-btn:hover{
      transform: translateY(-1px);
      filter: brightness(1.06);
    }
    .remove-cart-btn::after{
      content:"";
      position:absolute;
      inset:-30px;
      background: radial-gradient(closest-side, rgba(255,43,214,.18), transparent 60%);
      opacity: 0;
      transform: scale(.7);
      pointer-events:none;
      transition: opacity .2s ease;
    }
    .remove-cart-btn:hover::after{
      opacity: 1;
      animation: pulse 900ms ease-out infinite;
    }

    /* ========== ADMIN + SUGGESTION PANELS ========== */
    #adminSection, #suggestionSection{
      margin-top: 22px;
      padding: 16px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
    }

    #adminSection h2, #suggestionSection h2{
      margin: 0 0 8px;
      font-size: 16px;
      letter-spacing: .5px;
      text-transform: uppercase;
      color: rgba(233,247,255,.92);
      text-shadow: var(--glow-cyan);
    }

    .admin-status{
      font-size: 13px;
      color: var(--muted);
      margin: 0 0 10px;
    }

    .admin-login-form{
      display:flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items:center;
      margin-bottom: 10px;
    }

    .admin-actions{
      display:flex;
      gap: 8px;
      flex-wrap: wrap;
      margin: 10px 0 12px;
    }

    .admin-btn{
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(37,246,255,.25);
      background: rgba(37,246,255,.08);
      color: var(--text);
      cursor:pointer;
      box-shadow: var(--glow-cyan);
      font-size: 13px;
      position: relative;
      overflow:hidden;
    }
    .admin-btn:hover{ filter: brightness(1.06); }
    .admin-btn::after{
      content:"";
      position:absolute;
      inset:-30px;
      background: radial-gradient(closest-side, rgba(37,246,255,.18), transparent 60%);
      opacity: 0;
      transform: scale(.7);
      pointer-events:none;
      transition: opacity .2s ease;
    }
    .admin-btn:hover::after{
      opacity: 1;
      animation: pulse 900ms ease-out infinite;
    }

    .admin-product-grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .admin-product-grid textarea{
      grid-column: 1 / -1;
      resize: vertical;
      min-height: 70px;
    }
    .admin-product-form-buttons{
      margin-top: 10px;
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .admin-products-table{
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
      margin-top: 12px;
    }
    .admin-products-table th,
    .admin-products-table td{
      border: 1px solid rgba(255,255,255,.10);
      padding: 10px;
      text-align:left;
      vertical-align: middle;
    }
    .admin-products-table th{
      background: rgba(0,0,0,.15);
      text-transform: uppercase;
      letter-spacing: .4px;
      font-size: 12px;
    }
    .admin-product-actions-btn{
      padding: 7px 10px;
      font-size: 12px;
      border-radius: 999px;
      border: 1px solid rgba(155,92,255,.25);
      background: rgba(155,92,255,.10);
      color: var(--text);
      cursor:pointer;
      margin-right: 6px;
      box-shadow: 0 0 12px rgba(155,92,255,.20);
      position: relative;
      overflow:hidden;
    }
    .admin-product-actions-btn::after{
      content:"";
      position:absolute;
      inset:-30px;
      background: radial-gradient(closest-side, rgba(155,92,255,.18), transparent 60%);
      opacity: 0;
      transform: scale(.7);
      pointer-events:none;
      transition: opacity .2s ease;
    }
    .admin-product-actions-btn:hover::after{
      opacity: 1;
      animation: pulse 900ms ease-out infinite;
    }

    .suggestion-form{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 12px;
    }
    .suggestion-form textarea{
      grid-column: 1 / -1;
      min-height: 70px;
    }
    .suggestion-form button{
      grid-column: 1 / -1;
      justify-self: flex-start;
    }

    .suggestion-actions{
      display:flex;
      justify-content: space-between;
      align-items:center;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 10px;
      font-size: 14px;
      color: var(--muted);
    }

    .suggestion-list{
      display:flex;
      flex-direction: column;
      gap: 10px;
      max-height: 240px;
      overflow-y:auto;
      padding-right: 4px;
    }
    .suggestion-list::-webkit-scrollbar{ width: 10px; }
    .suggestion-list::-webkit-scrollbar-thumb{
      background: rgba(255,43,214,.16);
      border: 1px solid rgba(255,43,214,.22);
      border-radius: 99px;
    }

    .suggestion-card{
      border-radius: 12px;
      padding: 10px 12px;
      border: 1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(0,0,0,.20), rgba(0,0,0,.12));
      box-shadow: 0 12px 30px rgba(0,0,0,.35);
    }
    .suggestion-card-header{
      display:flex;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 4px;
      font-weight: 700;
      align-items:center;
      text-shadow: var(--glow-pink);
    }
    .suggestion-card-meta{
      font-size: 12px;
      opacity: .75;
      margin-bottom: 6px;
    }

    .copy-suggestions-btn{
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(37,246,255,.25);
      background: rgba(37,246,255,.08);
      color: var(--text);
      cursor:pointer;
      font-size: 13px;
      box-shadow: var(--glow-cyan);
      position: relative;
      overflow:hidden;
    }
    .copy-suggestions-btn::after{
      content:"";
      position:absolute;
      inset:-30px;
      background: radial-gradient(closest-side, rgba(37,246,255,.18), transparent 60%);
      opacity: 0;
      transform: scale(.7);
      pointer-events:none;
      transition: opacity .2s ease;
    }
    .copy-suggestions-btn:hover::after{
      opacity: 1;
      animation: pulse 900ms ease-out infinite;
    }

    .suggestion-admin-buttons button{
      padding: 6px 10px;
      font-size: 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      color: var(--text);
      cursor:pointer;
      margin-left: 6px;
      position: relative;
      overflow:hidden;
    }
    .suggestion-admin-buttons button::after{
      content:"";
      position:absolute;
      inset:-30px;
      background: radial-gradient(closest-side, rgba(255,255,255,.14), transparent 60%);
      opacity: 0;
      transform: scale(.7);
      pointer-events:none;
      transition: opacity .2s ease;
    }
    .suggestion-admin-buttons button:hover::after{
      opacity: 1;
      animation: pulse 900ms ease-out infinite;
    }

    /* ========== RESPONSIVE ========== */
    @media (max-width: 600px){
      .top-bar{ flex-direction: column; align-items: flex-start; }
      .search-box{ flex-direction: column; }
      .search-box button{ width: 100%; }
      .suggestion-form{ grid-template-columns: 1fr; }
      .admin-product-grid{ grid-template-columns: 1fr; }
      .search-box select{ flex: 1 1 auto; width: 100%; }
    }

    /* Accessibility - reduce motion */
    @media (prefers-reduced-motion: reduce){
      *{ animation: none !important; transition: none !important; }
    }
  </style>
</head>

<body class="dark">
  <header class="sticky-header">
    <div class="top-bar">
      <h1 class="glitch" data-text="Inventory Search by JAY">Inventory Search by JAY</h1>
      <button id="themeToggle" class="theme-toggle">Switch to Light Mode</button>
    </div>

    <div class="search-box">
      <!-- ✅ Option B: categories are generated by JS -->
      <select id="categorySelect"></select>

      <input type="text" id="searchInput" placeholder="Enter model, product name or brand" />
      <button id="searchButton">Search</button>
    </div>
  </header>

  <div class="layout">
    <!-- LEFT: PRODUCTS -->
    <main class="main">
      <div id="noResult" class="no-result"></div>
      <div id="loader" class="loader"></div>
      <div id="resultsContainer"></div>

      <section id="compareSection">
        <div class="compare-actions">
          <span class="compare-count" id="compareCountText"></span>
          <button class="clear-compare-btn" onclick="clearCompare()">Clear comparison</button>
        </div>
        <div id="compareContainer"></div>
      </section>
    </main>

    <!-- RIGHT: STICKY CART -->
    <aside class="sidebar">
      <section id="cartSection" class="sticky-cart neon-frame">
        <div class="cart-actions">
          <span class="cart-count" id="cartCountText"></span>
          <button class="download-quote-btn" onclick="downloadQuotation()">
            Download quotation (Excel)
          </button>
        </div>
        <div id="cartContainer"></div>
      </section>
    </aside>
  </div>

  <!-- Admin Panel -->
  <section id="adminSection">
    <h2>Admin Panel</h2>
    <p class="admin-status" id="adminStatusText">Not logged in.</p>

    <div id="adminLoggedOut">
      <form id="adminLoginForm" class="admin-login-form">
        <input type="password" id="adminPassword" placeholder="Enter admin password" required />
        <button type="submit">Login</button>
      </form>
      <p style="font-size:12px; opacity:0.7; margin:0;">
        Note: This is a simple frontend-only password. Do not use a real company password here.
      </p>
    </div>

    <div id="adminLoggedIn" style="display:none;">
      <div class="admin-actions">
        <button type="button" class="admin-btn" onclick="adminLogout()">Logout</button>
        <button type="button" class="admin-btn" onclick="clearAllSuggestions()">Clear all suggestions</button>
        <button type="button" class="admin-btn" onclick="copySuggestions()">Copy suggestions (CSV)</button>
      </div>

      <h3 style="margin:12px 0 6px; font-size:15px; letter-spacing:.4px; text-transform:uppercase;">
        Manage Products
      </h3>

      <form id="productForm" class="admin-product-form">
        <div class="admin-product-grid">
          <input type="text" id="prodBrand" placeholder="Brand (e.g. DVDO)" />
          <input type="text" id="prodModel" placeholder="Model (required)" required />
          <input type="text" id="prodName" placeholder="Product name / title" />
         <select id="prodCategory" required>
  <!-- options are injected by JS -->
</select>
          <input type="text" id="prodImage" placeholder="Image URL (optional)" />
          <textarea id="prodDescription" placeholder="Description"></textarea>
          <textarea id="prodSpecs" placeholder="Specs (one per line, e.g. Resolution: 1080p)"></textarea>
        </div>
        <div class="admin-product-form-buttons">
          <button type="submit" id="productFormSubmitBtn">Add product</button>
          <button type="button" id="productFormCancelEditBtn" style="display:none;" onclick="cancelProductEdit()">
            Cancel edit
          </button>
        </div>
      </form>

      <div id="adminProductsList"></div>
    </div>
  </section>

  <!-- Suggestion Box -->
  <section id="suggestionSection">
    <h2>Product Suggestion Box</h2>
    <p style="font-size:14px; opacity:0.8; margin:0 0 10px;">
      Can't find a product? Suggest it here so it can be added to the inventory list.
    </p>

    <form id="suggestionForm" class="suggestion-form">
      <input type="text" id="suggestBrand" placeholder="Brand (e.g. SONY)" required />
      <input type="text" id="suggestModel" placeholder="Model (e.g. PXW-Z90)" required />
      <input type="text" id="suggestName" placeholder="Product name / short title" />
      <textarea id="suggestNotes" placeholder="Extra details (link, specs, customer request, etc.)"></textarea>
      <button type="submit">Add suggestion</button>
    </form>

    <div class="suggestion-actions">
      <span id="suggestionCountText">No suggestions yet.</span>
      <button type="button" class="copy-suggestions-btn" onclick="copySuggestions()">
        Copy all suggestions
      </button>
    </div>

    <div id="suggestionsList" class="suggestion-list"></div>
  </section>

  <script>
    /* ---------- DATA & STORAGE ---------- */
    const DEFAULT_PRODUCTS = [
      {
        model: "DVDO-C4-1-B",
        brand: "DVDO",
        name: "DVDO PTZ CAMERA 1080P",
        category: "camera",
        description: "Full HD PTZ Camera with HDMI/IP/3G-SDI/USB & AI Auto Tracking (Black)",
        image: "https://dvdo.com/cdn/shop/products/DVDO-C4-1-2_700x.png?v=1672342619",
        specs: { "Resolution": "1080p", "Outputs": "HDMI, 3G-SDI, USB, IP", "AI Auto Tracking": "Yes", "Optical Zoom": "12x", "Color": "Black" }
      },
      {
        model: "DVDO-C5-1-B",
        brand: "DVDO",
        name: "DVDO PTZ CAMERA 4K",
        category: "camera",
        description: "4K PTZ Camera with HDMI/IP/3G-SDI/USB & AI Auto Tracking (Black)",
        image: "https://dvdo.com/cdn/shop/files/C5-1BlackFront-croppednoshade_700x.png?v=1713050748",
        specs: { "Resolution": "4K", "Outputs": "HDMI, 3G-SDI, USB, IP", "AI Auto Tracking": "Yes", "Optical Zoom": "12x", "Color": "Black" }
      },
      {
        model: "DVDO-CB-5-B",
        brand: "DVDO",
        name: "DVDO PTZ CAMERA BRACKET",
        category: "accessory",
        description: "Black Ceiling Bracket for C3 & C7WIFI PTZ Cameras",
        image: "https://dvdo.com/cdn/shop/files/DVDO-CB-5-Bpicture1_1024x.jpg?v=1748024159",
        specs: { "Type": "Ceiling Bracket", "Compatible Models": "C3, C7WIFI", "Color": "Black", "Material": "Metal" }
      },
      {
        model: "U-BRIDGE USB-C",
        brand: "INOGENI",
        name: "INOGENI USB BRIDGE",
        category: "converter",
        description: "USB-C EXT – USB and DP Alt Mode",
        image: "https://inogeni.com/wp-content/uploads/2025/03/Front-ISO-Hero-430x300-1.png",
        specs: { "Interface": "USB-C", "Function": "USB & DP Alt Mode Extension", "Use Case": "USB bridge / extender" }
      },
      {
        model: "SDI2USB3",
        brand: "INOGENI",
        name: "INOGENI SDI TO USB CONVERTER",
        category: "converter",
        description: "3G-SDI to USB 3.0 video converter (+ loop)",
        image: "https://inogeni.com/wp-content/uploads/2022/09/inogeni-sdi2usb3-header-product-1.png",
        specs: { "Input": "3G-SDI", "Output": "USB 3.0", "Loop Output": "Yes", "Max Resolution": "Up to 1080p" }
      },
      {
        model: "CAP-1",
        brand: "DATAVIDEO",
        name: "DATAVIDEO SDI TO USB CONVERTER",
        category: "converter",
        description: "3SDI to USB 3.0 Capture Box",
        image: "https://d3c9kujynjspib.cloudfront.net/images/33673c36e0c073fe12812e08.jpg",
        specs: { "Input": "3G-SDI", "Output": "USB 3.0", "Use Case": "Capture Box", "Max Resolution": "Up to 1080p" }
      }
    ];

    let products = [];
    let compareSelection = [];
    let cart = [];
    let suggestions = [];

    const PRODUCTS_STORAGE_KEY = "inventoryProducts";
    const SUGGESTIONS_STORAGE_KEY = "inventorySuggestions";
    const ADMIN_SESSION_KEY = "inventoryIsAdmin";
    const ADMIN_PASSWORD = "microdata";

    let isAdmin = false;
    let editingProductIndex = null;

    /* ---------- DOM ELEMENTS ---------- */
    const searchInput = document.getElementById("searchInput");
    const searchButton = document.getElementById("searchButton");
    const noResultEl = document.getElementById("noResult");
    const resultsContainer = document.getElementById("resultsContainer");
    const loader = document.getElementById("loader");
    const categorySelect = document.getElementById("categorySelect");
    const compareSection = document.getElementById("compareSection");
    const compareContainer = document.getElementById("compareContainer");
    const compareCountText = document.getElementById("compareCountText");
    const themeToggle = document.getElementById("themeToggle");

    const cartSection = document.getElementById("cartSection");
    const cartContainer = document.getElementById("cartContainer");
    const cartCountText = document.getElementById("cartCountText");

    const suggestionForm = document.getElementById("suggestionForm");
    const suggestBrandInput = document.getElementById("suggestBrand");
    const suggestModelInput = document.getElementById("suggestModel");
    const suggestNameInput = document.getElementById("suggestName");
    const suggestNotesInput = document.getElementById("suggestNotes");
    const suggestionsListEl = document.getElementById("suggestionsList");
    const suggestionCountText = document.getElementById("suggestionCountText");

    const adminLoginForm = document.getElementById("adminLoginForm");
    const adminPasswordInp = document.getElementById("adminPassword");
    const adminLoggedOut = document.getElementById("adminLoggedOut");
    const adminLoggedIn = document.getElementById("adminLoggedIn");
    const adminStatusText = document.getElementById("adminStatusText");

    const productForm = document.getElementById("productForm");
    const prodBrandInput = document.getElementById("prodBrand");
    const prodModelInput = document.getElementById("prodModel");
    const prodNameInput = document.getElementById("prodName");
    const prodCategoryInput = document.getElementById("prodCategory");
    const prodImageInput = document.getElementById("prodImage");
    const prodDescriptionInput = document.getElementById("prodDescription");
    const prodSpecsInput = document.getElementById("prodSpecs");
    const productFormSubmitBtn = document.getElementById("productFormSubmitBtn");
    const productFormCancelEditBtn = document.getElementById("productFormCancelEditBtn");
    const adminProductsList = document.getElementById("adminProductsList");

    /* ---------- STORAGE HELPERS ---------- */
    function loadProducts(){
      try{
        const raw = localStorage.getItem(PRODUCTS_STORAGE_KEY);
        if(raw){
          const parsed = JSON.parse(raw);
          if(Array.isArray(parsed) && parsed.length){
            products = parsed;
            return;
          }
        }
      }catch(e){
        console.warn("Failed to load products, using defaults.", e);
      }
      products = DEFAULT_PRODUCTS.slice();
    }

    function saveProducts(){
      try{
        localStorage.setItem(PRODUCTS_STORAGE_KEY, JSON.stringify(products));
      }catch(e){
        console.warn("Failed to save products.", e);
      }
    }

    function loadSuggestions(){
      try{
        const raw = localStorage.getItem(SUGGESTIONS_STORAGE_KEY);
        if(raw){
          suggestions = JSON.parse(raw) || [];
        }
      }catch(e){
        suggestions = [];
      }
      renderSuggestions();
    }

    function saveSuggestions(){
      localStorage.setItem(SUGGESTIONS_STORAGE_KEY, JSON.stringify(suggestions));
    }

    /* ---------- ✅ OPTION B: DYNAMIC CATEGORY DROPDOWN ---------- */
    function formatCategoryLabel(cat){
      // "ptz-camera" -> "PTZ Camera", "usb_converter" -> "USB Converter"
      return (cat || "")
        .trim()
        .toLowerCase()
        .replace(/[_-]+/g, " ")
        .split(" ")
        .filter(Boolean)
        .map(w => (w.length <= 3 ? w.toUpperCase() : w[0].toUpperCase() + w.slice(1)))
        .join(" ");
    }

    function renderCategoryOptions(){
      const categories = Array.from(
        new Set(
          products
            .map(p => (p.category || "").trim().toLowerCase())
            .filter(Boolean)
        )
      ).sort();

      categorySelect.innerHTML = `
        <option value="all">All Categories</option>
        ${categories.map(c => `
          <option value="${c}">${formatCategoryLabel(c)}</option>
        `).join("")}
      `;
    }

    /* ---------- THEME TOGGLE ---------- */
    function applyTheme(theme){
      document.body.classList.remove("dark", "light");
      document.body.classList.add(theme);
      themeToggle.textContent = theme === "dark" ? "Switch to Light Mode" : "Switch to Dark Mode";
      localStorage.setItem("inventoryTheme", theme);
    }

    (function initTheme(){
      const saved = localStorage.getItem("inventoryTheme");
      if(saved === "dark" || saved === "light") applyTheme(saved);
      else applyTheme("dark");
    })();

    themeToggle.addEventListener("click", ()=>{
      const current = document.body.classList.contains("dark") ? "dark" : "light";
      applyTheme(current === "dark" ? "light" : "dark");
    });

    /* ---------- SEARCH + FILTER ---------- */
    function searchProduct(){
      const query = searchInput.value.trim().toLowerCase();
      const selectedCategory = categorySelect.value;

      loader.style.display = "block";
      resultsContainer.innerHTML = "";
      noResultEl.style.display = "none";

      setTimeout(()=>{
        const matches = products.filter(p=>{
          const model = (p.model || "").toLowerCase();
          const name  = (p.name || "").toLowerCase();
          const brand = (p.brand || "").toLowerCase();
          const matchesText = !query || model.includes(query) || name.includes(query) || brand.includes(query);

          // ✅ robust category match
          const pCat = (p.category || "").trim().toLowerCase();
          const matchesCategory = (selectedCategory === "all") || (pCat === selectedCategory);

          return matchesText && matchesCategory;
        });

        loader.style.display = "none";

        if(matches.length === 0){
          noResultEl.textContent = "No product found.";
          noResultEl.style.display = "block";
          return;
        }

        matches.forEach(product=>{
          const card = document.createElement("div");
          card.className = "result-card";

          const isChecked = compareSelection.includes(product.model);
          const catLabel = (product.category || "").toUpperCase();

          card.innerHTML = `
            <div class="result-header">
              <div>
                <p class="result-model">Model: ${product.model}</p>
                <h2 class="result-name">${product.name}</h2>
                <p class="result-meta">
                  <strong>Brand:</strong> ${product.brand || "-"}
                  <span class="chip">${catLabel}</span>
                </p>
              </div>
              <div class="result-actions">
                <label class="compare-toggle">
                  <input type="checkbox" ${isChecked ? "checked" : ""} onchange="toggleCompare(this, '${product.model}')" />
                  Compare
                </label>
                <button class="add-cart-btn" onclick="addToCart('${product.model}')">Add to cart</button>
              </div>
            </div>
            <p class="result-description">${product.description || ""}</p>
            ${product.image ? `<img class="result-image" src="${product.image}" alt="${product.name}">` : ""}
          `;

          resultsContainer.appendChild(card);
        });

        renderCompare();
      }, 260);
    }

    searchButton.addEventListener("click", searchProduct);
    searchInput.addEventListener("keydown", (event)=>{ if(event.key === "Enter") searchProduct(); });
    categorySelect.addEventListener("change", searchProduct);

    /* ---------- COMPARE ---------- */
    function toggleCompare(checkboxEl, model){
      const index = compareSelection.indexOf(model);

      if(checkboxEl.checked){
        if(compareSelection.length >= 3){
          alert("You can compare up to 3 products at a time.");
          checkboxEl.checked = false;
          return;
        }
        if(index === -1) compareSelection.push(model);
      }else{
        if(index !== -1) compareSelection.splice(index, 1);
      }
      renderCompare();
    }

    function clearCompare(){
      compareSelection = [];
      renderCompare();
      document.querySelectorAll(".compare-toggle input[type='checkbox']").forEach(cb=>cb.checked=false);
    }

    function renderCompare(){
      if(compareSelection.length === 0){
        compareSection.style.display = "none";
        compareContainer.innerHTML = "";
        compareCountText.textContent = "No products selected for comparison.";
        return;
      }

      const selectedProducts = products.filter(p=>compareSelection.includes(p.model));
      compareSection.style.display = "block";
      compareCountText.textContent = `Comparing ${compareSelection.length} product(s).`;

      const specKeySet = new Set();
      selectedProducts.forEach(p=>{
        if(p.specs) Object.keys(p.specs).forEach(k=>specKeySet.add(k));
      });
      const specKeys = Array.from(specKeySet);

      let tableHtml = `
        <table class="compare-table">
          <tr>
            <th>Feature</th>
            ${selectedProducts.map(p=>`<th>${p.name}</th>`).join("")}
          </tr>
          <tr>
            <th>Image</th>
            ${selectedProducts.map(p=>`<td>${p.image ? `<img class="compare-image" src="${p.image}" alt="${p.name}">` : "-"}</td>`).join("")}
          </tr>
          <tr>
            <th>Model</th>
            ${selectedProducts.map(p=>`<td>${p.model}</td>`).join("")}
          </tr>
          <tr>
            <th>Brand</th>
            ${selectedProducts.map(p=>`<td>${p.brand || "-"}</td>`).join("")}
          </tr>
          <tr>
            <th>Category</th>
            ${selectedProducts.map(p=>`<td>${(p.category || "").toUpperCase()}</td>`).join("")}
          </tr>
          <tr>
            <th>Description</th>
            ${selectedProducts.map(p=>`<td>${p.description || ""}</td>`).join("")}
          </tr>
      `;

      if(specKeys.length > 0){
        tableHtml += `<tr><th colspan="${selectedProducts.length + 1}">Specifications</th></tr>`;
        specKeys.forEach(key=>{
          tableHtml += `
            <tr>
              <th>${key}</th>
              ${selectedProducts.map(p=>`<td>${(p.specs && p.specs[key]) ? p.specs[key] : "-"}</td>`).join("")}
            </tr>
          `;
        });
      }

      tableHtml += `</table>`;
      compareContainer.innerHTML = tableHtml;
    }

    /* ---------- CART / QUOTATION (CARD LIST) ---------- */
    function addToCart(model){
      const product = products.find(p=>p.model === model);
      if(!product) return;

      const existing = cart.find(item=>item.model === model);
      if(existing) existing.quantity += 1;
      else{
        cart.push({
          model: product.model,
          name: product.name,
          brand: product.brand || "",
          description: product.description || "",
          quantity: 1
        });
      }
      renderCart();
    }

    function removeFromCart(model){
      cart = cart.filter(item=>item.model !== model);
      renderCart();
    }

    function updateCartQuantity(model, newQty){
      const qty = parseInt(newQty, 10);
      if(isNaN(qty) || qty <= 0) return;
      const item = cart.find(i=>i.model === model);
      if(!item) return;
      item.quantity = qty;
      renderCart();
    }

    function renderCart(){
      if(cart.length === 0){
        cartSection.style.display = "none";
        cartContainer.innerHTML = "";
        cartCountText.textContent = "Cart is empty.";
        return;
      }

      cartSection.style.display = "block";
      const totalItems = cart.reduce((sum, item)=>sum + item.quantity, 0);
      cartCountText.textContent = `Cart: ${cart.length} product(s), ${totalItems} item(s) total.`;

      cartContainer.innerHTML = `
        <div class="cart-list">
          ${cart.map(item=>`
            <div class="cart-item">
              <div class="cart-top">
                <div class="cart-title">
                  <div class="brand">${item.brand || "-"}</div>
                  <div class="model">${item.model}</div>
                </div>
              </div>

              <div class="cart-desc">${item.description || ""}</div>

              <div class="cart-controls">
                <div class="qty-wrap">
                  <span>Qty</span>
                  <input type="number" min="1" value="${item.quantity}"
                    onchange="updateCartQuantity('${item.model}', this.value)" />
                </div>

                <button class="remove-cart-btn" onclick="removeFromCart('${item.model}')">
                  Remove
                </button>
              </div>
            </div>
          `).join("")}
        </div>
      `;
    }

    function csvEscape(value){
      if(value == null) return "";
      const str = String(value);
      if(/[",\n\r]/.test(str)) return '"' + str.replace(/"/g, '""') + '"';
      return str;
    }

    function downloadQuotation(){
      if(cart.length === 0){
        alert("Cart is empty. Add products before generating a quotation.");
        return;
      }

      const rows = [];
      rows.push(["Brand","Model","Description","Quantity"]);

      cart.forEach(item=>{
        rows.push([
          csvEscape(item.brand || ""),
          csvEscape(item.model),
          csvEscape(item.description),
          csvEscape(item.quantity)
        ]);
      });

      const csvContent = rows.map(r=>r.join(",")).join("\r\n");
      const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");
      const today = new Date().toISOString().slice(0,10);
      link.href = url;
      link.download = `quotation_${today}.csv`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
    }

    /* ---------- SPECS HELPERS ---------- */
    function parseSpecsFromString(text){
      const specs = {};
      if(!text) return specs;
      text.split(/\r?\n/).forEach(line=>{
        const trimmed = line.trim();
        if(!trimmed) return;
        const [key, ...rest] = trimmed.split(":");
        const value = rest.join(":").trim();
        if(key) specs[key.trim()] = value || "";
      });
      return specs;
    }

    function specsToText(specs){
      if(!specs || typeof specs !== "object") return "";
      return Object.entries(specs).map(([k,v])=>`${k}: ${v}`).join("\n");
    }

    /* ---------- SUGGESTIONS ---------- */
    function renderSuggestions(){
      if(!suggestions.length){
        suggestionsListEl.innerHTML = "";
        suggestionCountText.textContent = "No suggestions yet.";
        return;
      }

      suggestionCountText.textContent = `Total suggestions: ${suggestions.length}`;

      suggestionsListEl.innerHTML = suggestions.map((s, index)=>`
        <div class="suggestion-card">
          <div class="suggestion-card-header">
            <span>${s.brand || "-"} • ${s.model || "-"}</span>
            ${isAdmin ? `
              <span class="suggestion-admin-buttons">
                <button type="button" onclick="approveSuggestion(${index})">Approve</button>
                <button type="button" onclick="deleteSuggestion(${index})">Delete</button>
              </span>
            ` : ""}
          </div>
          <div class="suggestion-card-meta">
            ${s.name ? `${s.name} • ` : ""}${s.createdAt}
          </div>
          <div>${s.notes ? s.notes : ""}</div>
        </div>
      `).join("");
    }

    suggestionForm.addEventListener("submit", (event)=>{
      event.preventDefault();

      const brand = suggestBrandInput.value.trim();
      const model = suggestModelInput.value.trim();
      const name  = suggestNameInput.value.trim();
      const notes = suggestNotesInput.value.trim();

      if(!brand || !model){
        alert("Please provide at least Brand and Model.");
        return;
      }

      const createdAt = new Date().toLocaleString();
      suggestions.push({ brand, model, name, notes, createdAt });
      saveSuggestions();
      renderSuggestions();

      suggestionForm.reset();
      suggestBrandInput.focus();
    });

    function copySuggestions(){
      if(!suggestions.length){
        alert("No suggestions to copy.");
        return;
      }

      const lines = [];
      lines.push("Brand, Model, Name, Notes, Created At");
      suggestions.forEach(s=>{
        lines.push([
          csvEscape(s.brand || ""),
          csvEscape(s.model || ""),
          csvEscape(s.name || ""),
          csvEscape(s.notes || ""),
          csvEscape(s.createdAt || "")
        ].join(","));
      });

      const text = lines.join("\n");

      if(navigator.clipboard && navigator.clipboard.writeText){
        navigator.clipboard.writeText(text)
          .then(()=>alert("All suggestions copied to clipboard."))
          .catch(()=>alert("Failed to copy. You can select and copy manually."));
      }else{
        alert("Clipboard not available. You can select and copy the text manually.");
      }
    }

    function deleteSuggestion(index){
      suggestions.splice(index, 1);
      saveSuggestions();
      renderSuggestions();
    }

    function clearAllSuggestions(){
      if(!isAdmin){ alert("Admin only."); return; }
      if(!suggestions.length){ alert("No suggestions to clear."); return; }
      if(confirm("Are you sure you want to delete ALL suggestions?")){
        suggestions = [];
        saveSuggestions();
        renderSuggestions();
      }
    }

    function approveSuggestion(index){
      if(!isAdmin){ alert("Admin only."); return; }
      const s = suggestions[index];
      if(!s) return;

      const defaultName = (s.name || `${s.brand || ""} ${s.model || ""}`).trim();
      let category = prompt("Enter category for this product (camera / converter / accessory):", "converter");
      if(!category) category = "converter";
      category = category.toLowerCase().trim();

      const image = prompt("Enter image URL for this product (optional):", "") || "";
      const specsText = prompt("Enter basic specs (optional, one per line as 'Key: Value'):", "");
      const specs = parseSpecsFromString(specsText);

      const newProduct = {
        model: (s.model || "").trim(),
        brand: (s.brand || "").trim(),
        name: defaultName || "New Product",
        category,
        description: s.notes || s.name || "",
        image,
        specs
      };

      if(!newProduct.model){
        alert("Suggestion has no model, cannot create product.");
        return;
      }

      const existingIndex = products.findIndex(p=>p.model === newProduct.model);
      if(existingIndex !== -1){
        if(!confirm("A product with this model already exists. Replace it?")) return;
        products[existingIndex] = newProduct;
      }else{
        products.push(newProduct);
      }

      saveProducts();
      suggestions.splice(index, 1);
      saveSuggestions();

      renderCategoryOptions();   // ✅ keep categories updated
      renderSuggestions();
      renderAdminProducts();
      searchProduct();
    }

    /* ---------- ADMIN PRODUCT MANAGEMENT ---------- */
    function renderAdminProducts(){
      if(!isAdmin){
        adminProductsList.innerHTML = `
          <p style="font-size:13px; opacity:0.8; margin:0;">
            Login as admin to manage products.
          </p>`;
        return;
      }

      if(!products.length){
        adminProductsList.innerHTML = `
          <p style="font-size:13px; opacity:0.8; margin:0;">
            No products found. Use the form above to add one.
          </p>`;
        return;
      }

      const rowsHtml = products.map((p, index)=>`
        <tr>
          <td>${p.brand || "-"}</td>
          <td>${p.model}</td>
          <td>${p.name || ""}</td>
          <td>${(p.category || "").toUpperCase()}</td>
          <td>
            <button type="button" class="admin-product-actions-btn" onclick="startEditProduct(${index})">Edit</button>
            <button type="button" class="admin-product-actions-btn" onclick="deleteProduct(${index})">Delete</button>
          </td>
        </tr>
      `).join("");

      adminProductsList.innerHTML = `
        <table class="admin-products-table">
          <tr>
            <th>Brand</th>
            <th>Model</th>
            <th>Name</th>
            <th>Category</th>
            <th>Actions</th>
          </tr>
          ${rowsHtml}
        </table>`;
    }

    productForm.addEventListener("submit", (event)=>{
      event.preventDefault();
      if(!isAdmin){ alert("Admin only."); return; }

      const brand = prodBrandInput.value.trim();
      const model = prodModelInput.value.trim();
      const name = prodNameInput.value.trim();
      let category = document.getElementById("prodCategory").value.trim().toLowerCase();
      const image = prodImageInput.value.trim();
      const description = prodDescriptionInput.value.trim();
      const specsText = prodSpecsInput.value.trim();
      const specs = parseSpecsFromString(specsText);

      if(!model){ alert("Model is required."); return; }
      if(!category) category = "converter";

      const productData = {
        model,
        brand,
        name: name || `${brand} ${model}`.trim() || "New Product",
        category,
        description,
        image,
        specs
      };

      if(editingProductIndex !== null){
        products[editingProductIndex] = productData;
      }else{
        const existingIndex = products.findIndex(p=>p.model === model);
        if(existingIndex !== -1){
          if(!confirm("A product with this model already exists. Replace it?")) return;
          products[existingIndex] = productData;
        }else{
          products.push(productData);
        }
      }

      saveProducts();
      productForm.reset();
      editingProductIndex = null;
      productFormSubmitBtn.textContent = "Add product";
      productFormCancelEditBtn.style.display = "none";

      renderCategoryOptions();   // ✅ keep categories updated
      renderAdminProducts();
      searchProduct();
    });

    function startEditProduct(index){
      if(!isAdmin) return;
      const p = products[index];
      if(!p) return;

      editingProductIndex = index;
      prodBrandInput.value = p.brand || "";
      prodModelInput.value = p.model || "";
      prodNameInput.value = p.name || "";
      renderAdminCategoryDropdown(p.category || "");
      prodImageInput.value = p.image || "";
      prodDescriptionInput.value = p.description || "";
      prodSpecsInput.value = specsToText(p.specs);

      productFormSubmitBtn.textContent = "Save changes";
      productFormCancelEditBtn.style.display = "inline-block";

      window.scrollTo({ top: document.getElementById("adminSection").offsetTop, behavior: "smooth" });
    }

    function deleteProduct(index){
      if(!isAdmin) return;
      const p = products[index];
      if(!p) return;
      if(!confirm(`Delete product ${p.model}?`)) return;

      const model = p.model;
      products.splice(index, 1);
      saveProducts();

      compareSelection = compareSelection.filter(m=>m !== model);
      cart = cart.filter(item=>item.model !== model);

      renderCategoryOptions();   // ✅ keep categories updated
      renderAdminProducts();
      renderCart();
      renderCompare();
      searchProduct();
    }

    function cancelProductEdit(){
      editingProductIndex = null;
      productForm.reset();
      productFormSubmitBtn.textContent = "Add product";
      productFormCancelEditBtn.style.display = "none";
    }

    /* ---------- ADMIN LOGIN ---------- */
    function updateAdminUI(){
      if(isAdmin){
        adminLoggedIn.style.display = "block";
        adminLoggedOut.style.display = "none";
        adminStatusText.textContent = "Admin logged in.";
      }else{
        adminLoggedIn.style.display = "none";
        adminLoggedOut.style.display = "block";
        adminStatusText.textContent = "Not logged in.";
      }
      renderSuggestions();
      renderAdminProducts();
    }

    adminLoginForm.addEventListener("submit", (event)=>{
      event.preventDefault();
      const pwd = adminPasswordInp.value;
      if(pwd === ADMIN_PASSWORD){
        isAdmin = true;
        sessionStorage.setItem(ADMIN_SESSION_KEY, "true");
        adminPasswordInp.value = "";
        updateAdminUI();
      }else{
        alert("Incorrect admin password.");
      }
    });

    function adminLogout(){
      isAdmin = false;
      sessionStorage.removeItem(ADMIN_SESSION_KEY);
      updateAdminUI();
    }

    function initAdmin(){
      const stored = sessionStorage.getItem(ADMIN_SESSION_KEY);
      if(stored === "true") isAdmin = true;
      updateAdminUI();
    }
    const CATEGORIES_STORAGE_KEY = "inventoryCategories";
let categories = [];

function loadCategories(){
  try{
    const raw = localStorage.getItem(CATEGORIES_STORAGE_KEY);
    if(raw){
      const parsed = JSON.parse(raw);
      if(Array.isArray(parsed)) categories = parsed;
    }
  }catch(e){}

  // If none saved yet, build from products + defaults
  if(!categories.length){
    const fromProducts = products
      .map(p => (p.category || "").trim().toLowerCase())
      .filter(Boolean);

    categories = Array.from(new Set(["camera","converter","accessory", ...fromProducts])).sort();
    saveCategories();
  }
}

function saveCategories(){
  localStorage.setItem(CATEGORIES_STORAGE_KEY, JSON.stringify(categories));
}

function renderAdminCategoryDropdown(selectedValue = ""){
  const select = document.getElementById("prodCategory");
  if(!select) return;

  const selected = (selectedValue || "").trim().toLowerCase();

  select.innerHTML = `
    <option value="" disabled ${selected ? "" : "selected"}>Select category</option>
    ${categories.map(c => `
      <option value="${c}" ${c === selected ? "selected" : ""}>
        ${formatCategoryLabel(c)}
      </option>
    `).join("")}
    <option value="__add_new__">+ Add new category...</option>
  `;
}

// When user chooses "+ Add new category..."
document.getElementById("prodCategory").addEventListener("change", (e)=>{
  if(e.target.value === "__add_new__"){
    let newCat = prompt("Enter new category name (e.g. switcher, mic, tripod):", "");
    if(!newCat){
      renderAdminCategoryDropdown(); // reset
      return;
    }
    newCat = newCat.trim().toLowerCase();
    if(!newCat){
      renderAdminCategoryDropdown();
      return;
    }

    if(!categories.includes(newCat)){
      categories.push(newCat);
      categories.sort();
      saveCategories();
    }

    // refresh both dropdowns
    renderAdminCategoryDropdown(newCat);
    renderCategoryOptions();
    searchProduct();
  }
});

    /* ---------- INIT ---------- */
  loadProducts();
  loadCategories();
  renderCategoryOptions();
  renderAdminCategoryDropdown();
  loadSuggestions();
  initAdmin();
  searchProduct();


    window.toggleCompare = toggleCompare;
    window.clearCompare = clearCompare;
    window.addToCart = addToCart;
    window.removeFromCart = removeFromCart;
    window.updateCartQuantity = updateCartQuantity;
    window.downloadQuotation = downloadQuotation;
    window.copySuggestions = copySuggestions;
    window.deleteSuggestion = deleteSuggestion;
    window.clearAllSuggestions = clearAllSuggestions;
    window.approveSuggestion = approveSuggestion;
    window.startEditProduct = startEditProduct;
    window.deleteProduct = deleteProduct;
    window.cancelProductEdit = cancelProductEdit;
    window.adminLogout = adminLogout;
  </script>
</body>
</html>
